{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 140, "column": 0}, "map": {"version":3,"sources":["file:///Users/jayantjagtap/Work/RoClubAssignment/app/api/auth/%5B...nextauth%5D/route.ts"],"sourcesContent":["\nimport NextAuth from 'next-auth';\nimport ZitadelProvider from 'next-auth/providers/zitadel';\nimport type { NextAuthOptions } from 'next-auth';\n\ndeclare module 'next-auth' {\n    interface Session {\n        user: {\n            id: string;\n            name?: string | null;\n            email?: string | null;\n            given_name?: string;\n            family_name?: string;\n            profile_picture?: string\n        };\n        accessToken?: string;\n    }\n}\n\ndeclare module 'next-auth/jwt' {\n    interface JWT {\n        given_name?: string;\n        family_name?: string;\n        accessToken?: string;\n    }\n}\n\nexport const authOptions: NextAuthOptions = {\n    providers: [\n        ZitadelProvider({\n            issuer: process.env.ZITADEL_ISSUER,\n            clientId: process.env.ZITADEL_CLIENT_ID ?? '',\n            clientSecret: process.env.ZITADEL_CLIENT_SECRET ?? '',\n            authorization: { params: { scope: 'openid email profile' } },\n        }),\n    ],\n    callbacks: {\n        async session({ session, token }) {\n            session.user = {\n                ...session.user,\n                id: token.sub || '',\n                name: token.name || null,\n                email: token.email || null,\n                given_name: token.given_name,\n                family_name: token.family_name,\n                profile_picture: token.picture ?? \"\"\n            };\n            session.accessToken = token.accessToken;\n            return session;\n        },\n        async jwt({ token, account }) {\n            if (account?.access_token) {\n                token.accessToken = account.access_token;\n\n                if (!token.given_name) {\n                    try {\n                        const userinfo = await fetch(`${process.env.ZITADEL_ISSUER}/oidc/v1/userinfo`, {\n                            headers: { Authorization: `Bearer ${account.access_token}` },\n                        }).then(res => res.json());\n\n                        token.given_name = userinfo.given_name;\n                        token.family_name = userinfo.family_name;\n                        token.email = userinfo.email\n                        token.name = userinfo.name\n                        token.picture = userinfo.profile_picture\n\n                    } catch (error) {\n                        console.error('Failed to fetch userinfo:', error);\n                    }\n                }\n            }\n            return token;\n        },\n        async redirect({ url, baseUrl }) {\n\n            if (url.startsWith(\"/\")) return `${baseUrl}${url}`\n\n            else if (new URL(url).origin === baseUrl) return url\n            return baseUrl\n        },\n\n    },\n    pages: {\n        signIn: '/auth/signin',\n        // error: '/auth/error', // Error code passed in query string as ?error=\n    },\n    secret: process.env.AUTH_SECRET,\n};\n\nconst handler = NextAuth(authOptions);\nexport { handler as GET, handler as POST };"],"names":[],"mappings":";;;;;AACA;AACA;;;AAyBO,MAAM,cAA+B;IACxC,WAAW;QACP,CAAA,GAAA,oYAAA,CAAA,UAAe,AAAD,EAAE;YACZ,QAAQ,QAAQ,GAAG,CAAC,cAAc;YAClC,UAAU,QAAQ,GAAG,CAAC,iBAAiB,IAAI;YAC3C,cAAc,QAAQ,GAAG,CAAC,qBAAqB,IAAI;YACnD,eAAe;gBAAE,QAAQ;oBAAE,OAAO;gBAAuB;YAAE;QAC/D;KACH;IACD,WAAW;QACP,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC5B,QAAQ,IAAI,GAAG;gBACX,GAAG,QAAQ,IAAI;gBACf,IAAI,MAAM,GAAG,IAAI;gBACjB,MAAM,MAAM,IAAI,IAAI;gBACpB,OAAO,MAAM,KAAK,IAAI;gBACtB,YAAY,MAAM,UAAU;gBAC5B,aAAa,MAAM,WAAW;gBAC9B,iBAAiB,MAAM,OAAO,IAAI;YACtC;YACA,QAAQ,WAAW,GAAG,MAAM,WAAW;YACvC,OAAO;QACX;QACA,MAAM,KAAI,EAAE,KAAK,EAAE,OAAO,EAAE;YACxB,IAAI,SAAS,cAAc;gBACvB,MAAM,WAAW,GAAG,QAAQ,YAAY;gBAExC,IAAI,CAAC,MAAM,UAAU,EAAE;oBACnB,IAAI;wBACA,MAAM,WAAW,MAAM,MAAM,GAAG,QAAQ,GAAG,CAAC,cAAc,CAAC,iBAAiB,CAAC,EAAE;4BAC3E,SAAS;gCAAE,eAAe,CAAC,OAAO,EAAE,QAAQ,YAAY,EAAE;4BAAC;wBAC/D,GAAG,IAAI,CAAC,CAAA,MAAO,IAAI,IAAI;wBAEvB,MAAM,UAAU,GAAG,SAAS,UAAU;wBACtC,MAAM,WAAW,GAAG,SAAS,WAAW;wBACxC,MAAM,KAAK,GAAG,SAAS,KAAK;wBAC5B,MAAM,IAAI,GAAG,SAAS,IAAI;wBAC1B,MAAM,OAAO,GAAG,SAAS,eAAe;oBAE5C,EAAE,OAAO,OAAO;wBACZ,QAAQ,KAAK,CAAC,6BAA6B;oBAC/C;gBACJ;YACJ;YACA,OAAO;QACX;QACA,MAAM,UAAS,EAAE,GAAG,EAAE,OAAO,EAAE;YAE3B,IAAI,IAAI,UAAU,CAAC,MAAM,OAAO,GAAG,UAAU,KAAK;iBAE7C,IAAI,IAAI,IAAI,KAAK,MAAM,KAAK,SAAS,OAAO;YACjD,OAAO;QACX;IAEJ;IACA,OAAO;QACH,QAAQ;IAEZ;IACA,QAAQ,QAAQ,GAAG,CAAC,WAAW;AACnC;AAEA,MAAM,UAAU,CAAA,GAAA,qXAAA,CAAA,UAAQ,AAAD,EAAE","debugId":null}}]
}